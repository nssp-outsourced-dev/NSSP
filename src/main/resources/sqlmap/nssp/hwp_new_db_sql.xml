<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'> 
<sqlMap namespace="hwp">
	<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
	<!-- 조사 -->
	<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
	
	<!-- 서식1 변호인 변호사 참여신청 -->
	<select id="selectHwp00000000000000000278" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
			A.TRGTER_NM /* 성명 */
			, C.ITIV_NO /* 내사번호 */ 
			, FN_RC_VIOLT_ROOT_NM(C.RC_NO) AS VIOLT_ROOT_NM /* 죄명 */
			, FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE /* 현재일 */
			, FN_USER_NM(C.CHARGER_ID) AS CHARGER_NM /* 담당자 */
		FROM RC_TMPR_TRGTER A
			JOIN RC_TMPR C ON A.RC_NO = C.RC_NO
		WHERE A.RC_NO = #P_RC_NO# AND A.TRGTER_SN = #P_TRGTER_SN#
	</select>
	
	<!-- 서식2 대표변호인 지정 등 건의 -->
	<select id="selectHwp00000000000000000279" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			A.TRGTER_NM /* 성명 */
			, C.ITIV_NO /* 내사번호 */ 
			, FN_RC_VIOLT_ROOT_NM(C.RC_NO) AS VIOLT_ROOT_NM /* 죄명 */
			, FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE /* 현재일 */
			, FN_USER_NM(C.CHARGER_ID) AS CHARGER_NM /* 담당자 */
		FROM RC_TMPR_TRGTER A
			JOIN RC_TMPR C ON A.RC_NO = C.RC_NO
		WHERE A.RC_NO = #P_RC_NO# AND A.TRGTER_SN = #P_TRGTER_SN#
	</select>
	
	<!-- 서식10 출석요구 (서식 교체 기존 00000000000000000022)
	<select id="selectHwp000" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT A.*, FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE
		FROM (
			SELECT
				D.TRGTER_NM AS TRGTER_NM,
				(CASE WHEN D.WRC_NM IS NOT NULL THEN TRIM(D.WRC_NM) ||'와(과) ' END) AS WRC_NM,
				FN_RC_VIOLT_ROOT_NM(A.RC_NO) AS VIOLT_ROOT_NM,
				TO_NUMBER(TO_CHAR(A.ATEND_DEMAND_DT,'YYYY'))||'. '||TO_NUMBER(TO_CHAR(A.ATEND_DEMAND_DT,'MM'))||'. '||TO_NUMBER(TO_CHAR(A.ATEND_DEMAND_DT,'DD'))||'. '
				|| TO_NUMBER(TO_CHAR(A.ATEND_DEMAND_DT,'HH24'))||':'||TO_CHAR(A.ATEND_DEMAND_DT,'MI') AS ATEND_DEMAND_DT,
				UR.TEL_NO AS TEL_NO,
				FN_USER_NM(B.CHARGER_ID) AS CHARGER_NM,
				FN_USER_NM(A.WRITNG_ID) AS WRITNG_NM,
				/*TO_CHAR(A.DEMAND_SN) AS DEMAND_SN,*/
				FN_CNVR_NO(A.VIEW_SN) AS DEMAND_SN,
				CASE WHEN D.TRGTER_SE_CD = '00697' THEN '정당한 이유 없이 출석요구에 응하지 아니하면 형사소송법의 규정에 따라 체포될 수 있습니다.'
				END AS ADD_MSG			/*피의자메세지*/
			FROM INV_PRSCT_ATEND A
			LEFT JOIN RC_TMPR_TRGTER D ON A.RC_NO = D.RC_NO AND A.TRGTER_SN = D.TRGTER_SN
			LEFT JOIN RC_TMPR B ON A.RC_NO = B.RC_NO
			LEFT JOIN CMN_USER UR ON B.CHARGER_ID = UR.ESNTL_ID
			WHERE A.RC_NO   = #P_RC_NO#
				AND A.TRGTER_SN = #P_TRGTER_SN#
				AND A.DEMAND_SN = #P_DEMAND_SN#
				AND A.USE_YN != 'N'
		) A
		RIGHT JOIN DUAL D ON 1 = 1
	</select>
	 -->
	 
	<!-- 서식11 참고인 출석요구 -->
	<select id="selectHwp00000000000000000280" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT A.*, FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE
		FROM (
			SELECT
				D.TRGTER_NM AS TRGTER_NM,
				(CASE WHEN D.WRC_NM IS NOT NULL THEN TRIM(D.WRC_NM) ||'와(과) ' END) AS WRC_NM,
				FN_RC_VIOLT_ROOT_NM(A.RC_NO) AS VIOLT_ROOT_NM,
				TO_NUMBER(TO_CHAR(A.ATEND_DEMAND_DT,'YYYY'))||'. '||TO_NUMBER(TO_CHAR(A.ATEND_DEMAND_DT,'MM'))||'. '||TO_NUMBER(TO_CHAR(A.ATEND_DEMAND_DT,'DD'))||'. '
				|| TO_NUMBER(TO_CHAR(A.ATEND_DEMAND_DT,'HH24'))||':'||TO_CHAR(A.ATEND_DEMAND_DT,'MI') AS ATEND_DEMAND_DT,
				UR.TEL_NO AS TEL_NO,
				FN_USER_NM(B.CHARGER_ID) AS CHARGER_NM,
				FN_USER_NM(A.WRITNG_ID) AS WRITNG_NM,
				/*TO_CHAR(A.DEMAND_SN) AS DEMAND_SN,*/
				FN_CNVR_NO(A.VIEW_SN) AS DEMAND_SN,
				CASE WHEN D.TRGTER_SE_CD = '00697' THEN '정당한 이유 없이 출석요구에 응하지 아니하면 형사소송법의 규정에 따라 체포될 수 있습니다.'
				END AS ADD_MSG			/*피의자메세지*/
			FROM INV_PRSCT_ATEND A
			LEFT JOIN RC_TMPR_TRGTER D ON A.RC_NO = D.RC_NO AND A.TRGTER_SN = D.TRGTER_SN
			LEFT JOIN RC_TMPR B ON A.RC_NO = B.RC_NO
			LEFT JOIN CMN_USER UR ON B.CHARGER_ID = UR.ESNTL_ID
			WHERE A.RC_NO   = #P_RC_NO#
				AND A.TRGTER_SN = #P_TRGTER_SN#
				AND A.DEMAND_SN = #P_DEMAND_SN#
				AND A.USE_YN != 'N'
		) A
		RIGHT JOIN DUAL D ON 1 = 1
	</select>
	
	<!-- 서식13 동석신청서(피의자) -->
	<select id="selectHwp00000000000000000281" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT A.*, FN_OZ_DATE(null, null) AS S_DATE
		FROM (
			SELECT
				RC_NO,
				TO_NUMBER(SUBSTR(A.CASE_NO , INSTR(A.CASE_NO, '-')+1)) AS CASE_NO,
				FN_RC_VIOLT_UPPER_NMS (A.RC_NO) AS VIOLT_NM,
				FN_RC_VIOLT_ROOT_NM(A.RC_NO) AS VIOLT_ROOT_NM,
				NVL(FN_RC_TRGTER_NM(A.RC_NO, '00697'),' ') AS TRGTER_NMS,
				FN_USER_NM(A.WRITNG_ID) AS WRITNG_NM,
				FN_USER_NM(A.CHARGER_ID) AS CHARGER_NM,
				A.CRMNL_FACT,
				A.PRSCT_DE /* 승인 일자 */
			FROM RC_TMPR A
			WHERE A.RC_NO = #P_RC_NO#
		) A
		RIGHT JOIN DUAL D ON 1 = 1
	</select>
	
	<!-- 서식14 동석신청서(피해자) -->
	<select id="selectHwp00000000000000000282" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT A.*, FN_OZ_DATE(null, null) AS S_DATE
		FROM (
			SELECT
				RC_NO,
				TO_NUMBER(SUBSTR(A.CASE_NO , INSTR(A.CASE_NO, '-')+1)) AS CASE_NO,
				FN_RC_VIOLT_UPPER_NMS (A.RC_NO) AS VIOLT_NM,
				FN_RC_VIOLT_ROOT_NM(A.RC_NO) AS VIOLT_ROOT_NM,
				NVL(FN_RC_TRGTER_NM(A.RC_NO, '00697'),' ') AS TRGTER_NMS,
				FN_USER_NM(A.WRITNG_ID) AS WRITNG_NM,
				FN_USER_NM(A.CHARGER_ID) AS CHARGER_NM,
				A.CRMNL_FACT,
				A.PRSCT_DE /* 승인 일자 */
			FROM RC_TMPR A
			WHERE A.RC_NO = #P_RC_NO#
		) A
		RIGHT JOIN DUAL D ON 1 = 1
	</select>
	
	<!-- 서식15 수사과정확인서(조사시) -->
	<select id="selectHwp00000000000000000283" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT A.*, FN_OZ_DATE(null, null) AS S_DATE
		FROM (
			SELECT
				RC_NO,
				FN_USER_NM(A.CHARGER_ID) AS CHARGER_NM
			FROM RC_TMPR A
			WHERE A.RC_NO = #P_RC_NO#
		) A
		RIGHT JOIN DUAL D ON 1 = 1
	</select>
	
	<!-- 서식16 수사과정확인서(미조사시) -->
	<select id="selectHwp00000000000000000284" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT A.*, FN_OZ_DATE(null, null) AS S_DATE
		FROM (
			SELECT
				RC_NO,
				FN_USER_NM(A.CHARGER_ID) AS CHARGER_NM
			FROM RC_TMPR A
			WHERE A.RC_NO = #P_RC_NO#
		) A
		RIGHT JOIN DUAL D ON 1 = 1
	</select>
	
	<!-- 서식23 진술서 (서식 교체 기존 00000000000000000016)
	<select id="selectHwp00000000" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			A.*, FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE
		FROM (
			SELECT
				A.TRGTER_NM,
				DGUARD.DECRYPT('TBL','ENC',A.TRGTER_RRN) AS TRGTER_RRN,
				A.WRC_NM,
				FN_CD_NM(A.OCCP_CD) AS OCCP_NM,
				A.ADRES_ADDR AS DWLSIT_ADDR,		/*주거지:DWLSIT_ZIP 주소:ADRES_ADDR*/
				A.REGBS_ADDR AS REGBS_ADDR,			/*등록지*/
				A.WRC_ADDR AS WRC_ADDR,				/*직장주소*/
				DGUARD.DECRYPT('TBL','ENC',A.OWNHOM_TEL) AS OWNHOM_TEL,		/*자택전화*/
				DGUARD.DECRYPT('TBL','ENC',A.HP_NO) AS HP_NO,				/*휴대전화*/
				A.WRC_TEL,			/*직장*/
				A.EMAIL,
				CASE WHEN C.CASE_NO IS NOT NULL THEN SUBSTR(C.CASE_NO,0,4)||' 감사조사 정식 제'||TO_NUMBER(SUBSTR(C.CASE_NO,INSTR(C.CASE_NO, '-')+1))
					ELSE
						CASE WHEN C.ITIV_NO IS NOT NULL THEN SUBSTR(C.ITIV_NO,0,4)||' 감사조사 내사 제'||TO_NUMBER(SUBSTR(C.ITIV_NO,INSTR(C.ITIV_NO, '-')+1))
						ELSE SUBSTR(C.RC_NO,0,4)||' 감사조사 임시 제'||TO_NUMBER(SUBSTR(C.RC_NO,INSTR(C.RC_NO, '-')+1))
						END
					END AS CASE_NO,
				FN_CD_NM(A.TRGTER_SE_CD) || DECODE(SUBSTR( FN_CD_NM(A.TRGTER_SE_CD),LENGTH(FN_CD_NM(A.TRGTER_SE_CD)) ),'인','으','') AS TRGTER_SE_NM
			FROM RC_TMPR_TRGTER A
				JOIN RC_TMPR C ON A.RC_NO = C.RC_NO
			WHERE A.RC_NO = #P_RC_NO#
				AND A.TRGTER_SN = #P_TRGTER_SN#
		) A
		RIGHT JOIN DUAL D ON 1 = 1
	</select>
	 -->
	 
	<!-- 서식24 진술거부권 및 변호인 조력권 고지 등 확인서 (서식 교체 기존 00000000000000000021) -->
	<select id="selectHwp000000000" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
			FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE /* 현재일 */
		FROM DUAL 
	</select>
	
	<!-- 서식25 영상녹화 동의서 (서식 교체 기존 00000000000000000021) -->
	<select id="selectHwp0000000000" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
			A.*
			, FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE
		FROM (
			SELECT
				TRGTER_NM,
				DGUARD.DECRYPT('TBL','ENC',TRGTER_RRN) AS TRGTER_RRN,
				ADRES_ADDR AS DWLSIT_ADDR,	/*주거지:DWLSIT_ZIP 주소:ADRES_ADDR*/
				FN_RC_VIOLT_ROOT_NM (RC_NO) AS VIOLT_ROOT_NM,
				FN_CD_NM (TRGTER_SE_CD) AS TRGTER_SE_NM
				--, (SELECT * FROM RC_TMPR WHERE RC_NO = )
			FROM RC_TMPR_TRGTER 
			WHERE RC_NO 	= #P_RC_NO#
				AND TRGTER_SN = #P_TRGTER_SN#
				AND USE_YN = 'Y'
		) A
		RIGHT JOIN DUAL D ON 1 = 1
	</select>
	
	<!-- 진술조서(1회) (서식 교체 기존 00000000000000000014)
	<select id="selectHwp00000000000" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			A.TRGTER_NM  	AS INPUT_1,
			A.TRGTER_RRN	AS INPUT_3,
			A.OCCP_NM		AS INPUT_4,
			A.WRC_NM		AS INPUT_5,	/*직장명*/
			A.DWLSIT_ADDR 	AS INPUT_6,
			A.REGBS_ADDR	AS INPUT_7,
			A.WRC_ADDR		AS INPUT_8,
			A.OWNHOM_TEL	AS INPUT_9,
			A.HP_NO			AS INPUT_10,
			A.WRC_TEL		AS INPUT_11,
			A.EMAIL			AS INPUT_12,
			A.VIOLT_ROOT_NM AS INPUT_13,
			FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS INPUT_14,
			A.CHARGER_NM 	AS INPUT_15,
			WRITNG_NM 		AS INPUT_16
		FROM (
			SELECT
				TRGTER_SN,
				TRGTER_NM,
				TRGTER_RRN,
				OCCP_NM,
				WRC_NM,
				DWLSIT_ADDR,
				REGBS_ADDR,
				WRC_ADDR,
				OWNHOM_TEL,
				HP_NO,
				WRC_TEL,
				EMAIL,
				FN_RC_VIOLT_ROOT_NM(RC_NO) AS VIOLT_ROOT_NM,
				CHARGER_NM,
				WRITNG_NM,
				SORT_ORDR
			FROM (
				SELECT
					A.RC_NO,
					C.CASE_NO,
					A.TRGTER_SE_CD,
					A.TRGTER_SN,
					A.TRGTER_NM,
					DGUARD.DECRYPT('TBL','ENC',A.TRGTER_RRN) AS TRGTER_RRN,
					FN_CD_NM(A.OCCP_CD) AS OCCP_NM,
					A.WRC_NM,
					A.ADRES_ADDR AS DWLSIT_ADDR,		/*주거지:DWLSIT_ZIP 주소:ADRES_ADDR*/
					A.REGBS_ADDR AS REGBS_ADDR,			/*등록지*/
					A.WRC_ADDR AS WRC_ADDR,			/*직장주소*/
					DGUARD.DECRYPT('TBL','ENC',A.OWNHOM_TEL) AS OWNHOM_TEL,		/*자택전화*/
					DGUARD.DECRYPT('TBL','ENC',A.HP_NO) AS HP_NO,			/*휴대전화*/
					A.WRC_TEL,			/*직장*/
					A.EMAIL,
					FN_USER_NM(C.CHARGER_ID) AS CHARGER_NM,
					FN_USER_NM(A.WRITNG_ID) AS WRITNG_NM,
					(
						SELECT
							LISTAGG(RT.TRGTER_NM,', ') WITHIN GROUP(ORDER BY TRGTER_SN)
						FROM RC_TMPR_TRGTER RT
						WHERE RT.USE_YN = 'Y'
						AND RT.RC_NO  = A.RC_NO
						AND RT.TRGTER_SE_CD = '00697'
					) TRGTER_NM_S,	/*피의자*/
					A.SORT_ORDR
				FROM RC_TMPR_TRGTER A
				JOIN RC_TMPR C ON A.RC_NO = C.RC_NO
				WHERE A.RC_NO = #P_RC_NO#
					AND A.TRGTER_SN = #P_TRGTER_SN#
			) A
		) A
		ORDER BY A.SORT_ORDR, A.TRGTER_SN
	</select>
	 -->
	 
	<!-- 진술조서(2회 이상) -->
	<select id="selectHwp00000000000000000285" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			A.TRGTER_NM  	AS INPUT_1,
			A.TRGTER_RRN	AS INPUT_3,
			A.OCCP_NM		AS INPUT_4,
			A.WRC_NM		AS INPUT_5,	/*직장명*/
			A.DWLSIT_ADDR 	AS INPUT_6,
			A.REGBS_ADDR	AS INPUT_7,
			A.WRC_ADDR		AS INPUT_8,
			A.OWNHOM_TEL	AS INPUT_9,
			A.HP_NO			AS INPUT_10,
			A.WRC_TEL		AS INPUT_11,
			A.EMAIL			AS INPUT_12,
			A.VIOLT_ROOT_NM AS INPUT_13,
			FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS INPUT_14,
			A.CHARGER_NM 	AS INPUT_15,
			WRITNG_NM 		AS INPUT_16
		FROM (
			SELECT
				TRGTER_SN,
				TRGTER_NM,
				TRGTER_RRN,
				OCCP_NM,
				WRC_NM,
				DWLSIT_ADDR,
				REGBS_ADDR,
				WRC_ADDR,
				OWNHOM_TEL,
				HP_NO,
				WRC_TEL,
				EMAIL,
				FN_RC_VIOLT_ROOT_NM(RC_NO) AS VIOLT_ROOT_NM,
				CHARGER_NM,
				WRITNG_NM,
				SORT_ORDR
			FROM (
				SELECT
					A.RC_NO,
					C.CASE_NO,
					A.TRGTER_SE_CD,
					A.TRGTER_SN,
					A.TRGTER_NM,
					DGUARD.DECRYPT('TBL','ENC',A.TRGTER_RRN) AS TRGTER_RRN,
					FN_CD_NM(A.OCCP_CD) AS OCCP_NM,
					A.WRC_NM,
					A.ADRES_ADDR AS DWLSIT_ADDR,		/*주거지:DWLSIT_ZIP 주소:ADRES_ADDR*/
					A.REGBS_ADDR AS REGBS_ADDR,			/*등록지*/
					A.WRC_ADDR AS WRC_ADDR,			/*직장주소*/
					DGUARD.DECRYPT('TBL','ENC',A.OWNHOM_TEL) AS OWNHOM_TEL,		/*자택전화*/
					DGUARD.DECRYPT('TBL','ENC',A.HP_NO) AS HP_NO,			/*휴대전화*/
					A.WRC_TEL,			/*직장*/
					A.EMAIL,
					FN_USER_NM(C.CHARGER_ID) AS CHARGER_NM,
					FN_USER_NM(A.WRITNG_ID) AS WRITNG_NM,
					(
						SELECT
							LISTAGG(RT.TRGTER_NM,', ') WITHIN GROUP(ORDER BY TRGTER_SN)
						FROM RC_TMPR_TRGTER RT
						WHERE RT.USE_YN = 'Y'
						AND RT.RC_NO  = A.RC_NO
						AND RT.TRGTER_SE_CD = '00697'
					) TRGTER_NM_S,	/*피의자*/
					A.SORT_ORDR
				FROM RC_TMPR_TRGTER A
				JOIN RC_TMPR C ON A.RC_NO = C.RC_NO
				WHERE A.RC_NO = #P_RC_NO#
					AND A.TRGTER_SN = #P_TRGTER_SN#
			) A
		) A
		ORDER BY A.SORT_ORDR, A.TRGTER_SN
	</select>
	
	<!-- 진술조서(통역인 참여시) -->
	<select id="selectHwp00000000000000000286" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			A.TRGTER_NM  	AS INPUT_1,
			A.TRGTER_RRN	AS INPUT_3,
			A.OCCP_NM		AS INPUT_4,
			A.WRC_NM		AS INPUT_5,	/*직장명*/
			A.DWLSIT_ADDR 	AS INPUT_6,
			A.REGBS_ADDR	AS INPUT_7,
			A.WRC_ADDR		AS INPUT_8,
			A.OWNHOM_TEL	AS INPUT_9,
			A.HP_NO			AS INPUT_10,
			A.WRC_TEL		AS INPUT_11,
			A.EMAIL			AS INPUT_12,
			A.VIOLT_ROOT_NM AS INPUT_13,
			FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS INPUT_14,
			A.CHARGER_NM 	AS INPUT_15,
			WRITNG_NM 		AS INPUT_16
		FROM (
			SELECT
				TRGTER_SN,
				TRGTER_NM,
				TRGTER_RRN,
				OCCP_NM,
				WRC_NM,
				DWLSIT_ADDR,
				REGBS_ADDR,
				WRC_ADDR,
				OWNHOM_TEL,
				HP_NO,
				WRC_TEL,
				EMAIL,
				FN_RC_VIOLT_ROOT_NM(RC_NO) AS VIOLT_ROOT_NM,
				CHARGER_NM,
				WRITNG_NM,
				SORT_ORDR
			FROM (
				SELECT
					A.RC_NO,
					C.CASE_NO,
					A.TRGTER_SE_CD,
					A.TRGTER_SN,
					A.TRGTER_NM,
					DGUARD.DECRYPT('TBL','ENC',A.TRGTER_RRN) AS TRGTER_RRN,
					FN_CD_NM(A.OCCP_CD) AS OCCP_NM,
					A.WRC_NM,
					A.ADRES_ADDR AS DWLSIT_ADDR,		/*주거지:DWLSIT_ZIP 주소:ADRES_ADDR*/
					A.REGBS_ADDR AS REGBS_ADDR,			/*등록지*/
					A.WRC_ADDR AS WRC_ADDR,			/*직장주소*/
					DGUARD.DECRYPT('TBL','ENC',A.OWNHOM_TEL) AS OWNHOM_TEL,		/*자택전화*/
					DGUARD.DECRYPT('TBL','ENC',A.HP_NO) AS HP_NO,			/*휴대전화*/
					A.WRC_TEL,			/*직장*/
					A.EMAIL,
					FN_USER_NM(C.CHARGER_ID) AS CHARGER_NM,
					FN_USER_NM(A.WRITNG_ID) AS WRITNG_NM,
					(
						SELECT
							LISTAGG(RT.TRGTER_NM,', ') WITHIN GROUP(ORDER BY TRGTER_SN)
						FROM RC_TMPR_TRGTER RT
						WHERE RT.USE_YN = 'Y'
						AND RT.RC_NO  = A.RC_NO
						AND RT.TRGTER_SE_CD = '00697'
					) TRGTER_NM_S,	/*피의자*/
					A.SORT_ORDR
				FROM RC_TMPR_TRGTER A
				JOIN RC_TMPR C ON A.RC_NO = C.RC_NO
				WHERE A.RC_NO = #P_RC_NO#
					AND A.TRGTER_SN = #P_TRGTER_SN#
			) A
		) A
		ORDER BY A.SORT_ORDR, A.TRGTER_SN
	</select>
	
	<!-- 피의자신문조서(1회) (서식 교체 기존 00000000000000000032)
	<select id="selectHwp00000000000000" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			A.*, FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE
		FROM (
			SELECT
				FN_CNVR_NO(C.CASE_NO) AS CASE_NO,
				FN_CNVR_NO(A.RC_NO) AS RC_NO,
				A.TRGTER_SE_CD,
				A.TRGTER_SN,
				A.TRGTER_NM,
				DGUARD.DECRYPT('TBL','ENC',A.TRGTER_RRN) AS TRGTER_RRN,
				FN_CD_NM(A.OCCP_CD) || (CASE WHEN A.WRC_NM IS NOT NULL THEN ' (' || TRIM(A.WRC_NM) || ')' END) AS OCCP_NM,
				A.ADRES_ADDR AS DWLSIT_ADDR,		/*주거지:DWLSIT_ZIP 주소:ADRES_ADDR*/
				A.REGBS_ADDR AS REGBS_ADDR,		/*등록지*/
				A.WRC_ADDR AS WRC_ADDR,			/*직장주소*/
				DGUARD.DECRYPT('TBL','ENC',A.OWNHOM_TEL) AS OWNHOM_TEL,		/*자택전화*/
				DGUARD.DECRYPT('TBL','ENC',A.HP_NO) AS HP_NO,			/*휴대전화*/
				A.WRC_TEL,			/*직장*/
				A.EMAIL,
				FN_RC_VIOLT_ROOT_NM(C.RC_NO) AS VIOLT_ROOT_NM,
				FN_USER_NM(C.CHARGER_ID) AS CHARGER_NM,
				FN_USER_NM(A.WRITNG_ID) AS WRITNG_NM
			FROM RC_TMPR_TRGTER A
				JOIN RC_TMPR C ON A.RC_NO = C.RC_NO
			WHERE A.RC_NO 		= #P_RC_NO#
				AND A.TRGTER_SN 	= #P_TRGTER_SN#
		) A
		RIGHT JOIN DUAL D ON 1 = 1
	</select>
	 -->
	 
	<!-- 피의자신문조서(2회 이상) -->
	<select id="selectHwp00000000000000000287" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			A.*, FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE
		FROM (
			SELECT
				FN_CNVR_NO(C.CASE_NO) AS CASE_NO,
				FN_CNVR_NO(A.RC_NO) AS RC_NO,
				A.TRGTER_SE_CD,
				A.TRGTER_SN,
				A.TRGTER_NM,
				DGUARD.DECRYPT('TBL','ENC',A.TRGTER_RRN) AS TRGTER_RRN,
				FN_CD_NM(A.OCCP_CD) || (CASE WHEN A.WRC_NM IS NOT NULL THEN ' (' || TRIM(A.WRC_NM) || ')' END) AS OCCP_NM,
				A.ADRES_ADDR AS DWLSIT_ADDR,		/*주거지:DWLSIT_ZIP 주소:ADRES_ADDR*/
				A.REGBS_ADDR AS REGBS_ADDR,		/*등록지*/
				A.WRC_ADDR AS WRC_ADDR,			/*직장주소*/
				DGUARD.DECRYPT('TBL','ENC',A.OWNHOM_TEL) AS OWNHOM_TEL,		/*자택전화*/
				DGUARD.DECRYPT('TBL','ENC',A.HP_NO) AS HP_NO,			/*휴대전화*/
				A.WRC_TEL,			/*직장*/
				A.EMAIL,
				FN_RC_VIOLT_ROOT_NM(C.RC_NO) AS VIOLT_ROOT_NM,
				FN_USER_NM(C.CHARGER_ID) AS CHARGER_NM,
				FN_USER_NM(A.WRITNG_ID) AS WRITNG_NM
			FROM RC_TMPR_TRGTER A
				JOIN RC_TMPR C ON A.RC_NO = C.RC_NO
			WHERE A.RC_NO 		= #P_RC_NO#
				AND A.TRGTER_SN 	= #P_TRGTER_SN#
		) A
		RIGHT JOIN DUAL D ON 1 = 1
	</select>
	
	<!-- 서식- 유치인 조사요청서 -->
	<select id="selectHwp00000000000000000288" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
			FN_RC_VIOLT_ROOT_NM(C.RC_NO) AS VIOLT_ROOT_NM
		FROM RC_TMPR_TRGTER A
			JOIN RC_TMPR C ON A.RC_NO = C.RC_NO
		WHERE A.RC_NO = #P_RC_NO# AND ROWNUM <![CDATA[ <= ]]> 1
	</select>
	
	<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
	<!-- 내사수사 -->
	<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
	
	<!-- 서식5 수사개시 보고 -->
	<select id="selectHwp00000000000000000289" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
			FN_CNVR_NO(C.ITIV_NO) AS ITIV_NO /* 내사번호 */ 
			, FN_RC_VIOLT_ROOT_NM(C.RC_NO) AS VIOLT_ROOT_NM /* 죄명 */
			, FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE /* 현재일 */
			, FN_USER_NM(C.CHARGER_ID) AS CHARGER_NM /* 담당자 */
		FROM RC_TMPR C
		WHERE C.RC_NO = #P_RC_NO#
	</select>
	
	<!-- 서식8 범법자 출입국 규제 요청 지휘 건의 -->
	<select id="selectHwp00000000000000000299" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT
			FN_CNVR_NO(X.SUGEST_NO) AS SUGEST_NO /* 건의 번호 */
			--X.RC_NO,
			, FN_CNVR_NO((SELECT RT.CASE_NO FROM RC_TMPR RT WHERE RT.RC_NO = X.RC_NO)) AS CASE_NO /* 사건번호 */
			--(SELECT FN_OZ_DATE2(TO_CHAR(RT.RC_DT,'YYYYMMDD'),null) FROM RC_TMPR RT WHERE RT.RC_NO = X.RC_NO) AS RC_DT,
			, X.TRGTER_NM || CASE WHEN REGEXP_INSTR(SUBSTR(X.TRGTER_NM,-1,1),'[0-9]') > 0 THEN '명' END AS TRGTER_NM /* 성명 */
			, X.TRGTER_RRN /* 주민등록번호 */
			, X.DWLSIT_ADDR /* 주거 */
			, X.REGBS_ADDR /* 등록기분지 */
			--FN_CD_NM(X.SUGEST_TY_CD) AS SUGEST_TY_NM,
			, TO_CHAR(TO_DATE(X.SUGEST_DE,'YYYYMMDD'),'YYYY. MM. DD') AS SUGEST_DE /* 건의 일자 */
			, TO_CHAR(TO_DATE(X.CMND_DE,'YYYYMMDD'),'YYYY. MM. DD') AS CMND_DE /* 지휘 일자 */
			--FN_RCV_EXMN_NM((SELECT FN_EXMN_NM(IP.CMPTNC_EXMN_CD) FROM RC_TMPR IP WHERE IP.RC_NO = X.RC_NO)) AS CMPTNC_EXMN_NM,
			, FN_RC_VIOLT_ROOT_NM(X.RC_NO) AS VIOLT_NM /* 죄명 */
			, FN_USER_NM(WRITNG_ID) AS OZ_NM /* 작성자 */
			, FN_OZ_DATE(null, null) AS OZ_DT /* 현재일 */
			, (SELECT FN_CD_NM(cu.CLSF_CD) FROM CMN_USER cu WHERE ESNTL_ID = X.WRITNG_ID) AS CLSF_NM /* 직급 */
			, FN_CD_NM(X.SEXDSTN_CD) AS SEXDSTN_NM /* 성별 */
			, X.PASPORT_NO /* 여권번호 */
			, FN_CD_NM(X.OCCP_CD) AS OCCP_NM /* 직업 */
		FROM
		(
			SELECT
				MAX(S.SUGEST_NO) AS SUGEST_NO,
				MAX(S.RC_NO) AS RC_NO,
				MAX(S.SUGEST_TY_CD) AS SUGEST_TY_CD,
				MAX(S.SUGEST_DE) AS SUGEST_DE,
				MAX(S.CMND_DE) AS CMND_DE,
				MAX(PT.TRGTER_NM) KEEP(DENSE_RANK FIRST ORDER BY PT.SORT_ORDR,PT.TRGTER_SN ASC) || (CASE WHEN COUNT(DISTINCT(PT.TRGTER_SN)) > 1 THEN ' 외 '||(COUNT(DISTINCT(PT.TRGTER_SN))-1) END) AS TRGTER_NM,
				MAX(DGUARD.DECRYPT('TBL','ENC',PT.TRGTER_RRN)) KEEP(DENSE_RANK FIRST ORDER BY PT.SORT_ORDR,PT.TRGTER_SN ASC) AS TRGTER_RRN,
				MAX(PT.ADRES_ADDR) KEEP(DENSE_RANK FIRST ORDER BY PT.SORT_ORDR,PT.TRGTER_SN ASC) AS DWLSIT_ADDR,	/*주거지:DWLSIT_ZIP 주소:ADRES_ADDR*/
				MAX(S.WRITNG_ID) AS WRITNG_ID
				, MAX(PT.SEXDSTN_CD) AS SEXDSTN_CD
				, MAX(PT.PASPORT_NO) AS PASPORT_NO
				, MAX(PT.OCCP_CD) AS OCCP_CD
				, MAX(PT.REGBS_ADDR) AS REGBS_ADDR
			FROM INV_SUGEST S
			LEFT JOIN RC_TMPR_TRGTER PT ON S.RC_NO = PT.RC_NO AND PT.TRGTER_SE_CD IN (SELECT CC.ESNTL_CD FROM CMN_CD CC WHERE CC.UPPER_CD = '00102'  AND CC.CD_DC = 'suspct-Group')
			WHERE S.SUGEST_NO = #P_SUGEST_NO# AND S.USE_YN = 'Y'
		) X
	</select>
	
	<!-- 서식27 수사사항조회 -->
	<select id="selectHwp00000000000000000300" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
			A.TRGTER_NM /* 성명 */
			, C.ITIV_NO /* 내사번호 */
			, C.CASE_NO /* 사건번호 */
			, FN_RC_VIOLT_ROOT_NM(C.RC_NO) AS VIOLT_ROOT_NM /* 죄명 */
			, FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE /* 현재일 */
			, FN_USER_NM(C.CHARGER_ID) AS CHARGER_NM /* 담당자 */
		FROM RC_TMPR_TRGTER A
			JOIN RC_TMPR C ON A.RC_NO = C.RC_NO
		WHERE A.RC_NO = #P_RC_NO#
	</select>
	
	<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
	<!-- 송치 -->
	<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
	<!-- 서식 - 수사진행상황 통지서  -->
	<select id="selectHwp00000000000000000301" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
			FN_CNVR_NO(TRN_NO) TRN_NO /* 송치번호 */
			, FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE /* 현재일 */
			, FN_RC_TRGTER_NM(RC_NO, '00697') TRGTER_NM /* 피의자 성명 */
			, FN_TRN_DOC_VIOLT(TRN_NO) VIOLT_NM_LIST /* 죄명 */
			, FN_CNVR_NO(CASE_NO) CASE_NO /* 사건번호 */
			, CMPTNC_EXMN_NM /* 송치기관 */
			, NVL(TRN_DE, FN_OZ_DATE(NULL, NULL)) TRN_DE /* 송치 일자 */
			, FN_TRN_DOC_OPTION(TRN_NO) TRN_OPTION_NM_LIST /*송치 의견 */
			, TEL_NO /* 담당자 전화번호 */
			, CLSF_NM /* 직급 */
			, USER_NM /* 담당자명 */
		FROM (
			SELECT 
				A.TRN_NO
				, FN_OZ_DATE(TRN_DE, NULL) TRN_DE
				, FN_EXMN_NM (A.CMPTNC_EXMN_CD) CMPTNC_EXMN_NM
				--, FN_CD_NM (INV_PROVIS_CD) INV_PROVIS_NM
				--, FN_OZ_DATE(TO_CHAR(RC_DT, 'YYYYMMDD'), NULL) RC_DT
				, CASE_NO
				--, FN_OZ_DATE(PRSCT_DE, NULL) PRSCT_DE /* 입건일자 */
				, FN_CD_NM(CLSF_CD) CLSF_NM
				--, C.USER_NM
				, FN_USER_NM(B.CHARGER_ID) AS USER_NM -- 담당자로 변경 by dgkim
				--, DECODE(EVDENC_YN, 'Y', '있음', '없음')  EVDENC_YN
				--, EVDENC_DC
				--, TRN_RM /* 송치 비고 */
				, C.TEL_NO
				, B.RC_NO
			FROM TRN_CASE A
				, RC_TMPR B
				, CMN_USER C
			WHERE A.RC_NO = B.RC_NO
				AND A.USE_YN = 'Y'
				AND B.USE_YN = 'Y'
				AND B.WRITNG_ID = C.ESNTL_ID
				AND A.TRN_NO = #P_TRN_NO#
		) RIGHT JOIN DUAL ON 1=1
	</select>
	
	<!-- 서식 - 서식 지명수배,지명통보자 전산입력요구서  -->
	<select id="selectHwp00000000000000000302" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		
	</select>
	
	<!-- 서식138 추가 송부  -->
	<select id="selectHwp00000000000000000303" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
		SELECT 
			FN_CNVR_NO(TRN_NO) TRN_NO /* 송치번호 */
			, FN_OZ_DATE(TO_CHAR(SYSDATE,'YYYYMMDD'),'') AS S_DATE /* 현재일 */
			, CMPTNC_EXMN_NM /* 송치기관 */
			, FN_RC_TRGTER_NM(RC_NO, '00697') TRGTER_NM /* 피의자 성명 */
			, NVL(TRN_DE, FN_OZ_DATE(NULL, NULL)) TRN_DE /* 송치 일자 */
			, FN_CNVR_NO(CASE_NO) CASE_NO /* 사건번호 */
			, TRN_RM
			, CLSF_NM /* 직급 */
			, USER_NM /* 담당자명 */
		FROM 
		(
			SELECT 
				A.TRN_NO
				, FN_OZ_DATE(TRN_DE, NULL) TRN_DE
				, FN_EXMN_NM (A.CMPTNC_EXMN_CD) CMPTNC_EXMN_NM
				, CASE_NO
				, FN_CD_NM(CLSF_CD) CLSF_NM
				--, C.USER_NM
				, FN_USER_NM(B.CHARGER_ID) AS USER_NM -- 담당자로 변경 by dgkim
				, TRN_RM /* 송치 비고 */
				, B.RC_NO
			FROM TRN_CASE A
				, RC_TMPR B
				, CMN_USER C
			WHERE A.RC_NO = B.RC_NO
				AND A.USE_YN = 'Y'
				AND B.USE_YN = 'Y'
				AND B.WRITNG_ID = C.ESNTL_ID
				AND A.TRN_NO = #P_TRN_NO#
		) RIGHT JOIN DUAL ON 1=1
	</select>
	<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
	<!-- 사건대장 -->
	<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
	
	<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
	<!-- 영장 -->
	<!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->
	<!-- 서식9 수사기일 연장지휘 건의 -->
	<!-- 서식28 권리 고지 확인서 -->
	<!-- 서식37 피의자 석방보고 -->
	<!-- 서식44 체포ㆍ구속 통지 등 -->
	<!-- 서식56 압수ㆍ수색ㆍ검증영장신청(금융계좌 추적용) -->
	<!-- 서식57 압수ㆍ수색ㆍ검증영장신청(사후) -->
	<!-- 서식59 전자정보 삭제ㆍ폐기 또는 반환 확인서 -->
	<!-- 서식60 정보저장매체 복제 등 참관여부 확인서 -->
	<!-- 서식61 정보저장매체 제출 등 참관여부 확인서 -->
	<!-- 서식65 수색결과 증명서 -->
	<!-- 서식93 통신사실 확인자료제공요청 집행사실 통지보고 -->
	<!-- 서식94 송ㆍ수신이 완료된 전기통신에 대한 압수ㆍ수색ㆍ검증 집행사실 통지 -->
	<!-- 서식98 통신사실 확인자료제공 요청 -->
	<!-- 서식100 통신사실 확인자료제공 요청 집행조서 -->
	<!-- 서식102 통신사실 확인자료제공 요청중지통지 -->
	<!-- 서식103 통신사실 확인자료제공 요청 집행결과보고 -->
	<!-- 서식104 통신사실 확인자료제공 요청허가신청 -->
	<!-- 서식108 통신사실 확인자료제공 요청허가 신청(사후) -->
	<!-- 서식109 통신사실 확인자료제공 요청 집행사실 통지 -->
	<!-- 서식111 통신사실 확인자료제공 요청 집행사실 통지유예 승인신청 -->
	<!-- 서식118 영장반환 보고 -->
	<!-- 서식- 피의자 입감 지휘서 -->
	<!-- 서식- 피의자 출감 지휘서 -->
	<!-- 서식- 피의자(유치인)접견 등 금지요청서 -->
	<!-- 서식- 피의자(유치인)접견 등 금지취소 요청 -->
</sqlMap>